<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>ProHelmet — Payment Successful</title>
  <style>
    :root{
      --bg:#070a10;
      --text:#e9eef7;
      --muted:#a9b4c6;
      --line:rgba(255,255,255,.10);
      --ok:#22c55e;
      --shadow: 0 18px 60px rgba(0,0,0,.55);
      --radius:18px;
    }
    *{box-sizing:border-box}
    html, body { height: 100%; }

    body{
      margin:0;
      min-height:100svh;
      display:flex;
      align-items:center;
      justify-content:center;
      background:
        radial-gradient(1000px 600px at 50% 20%, rgba(45,76,140,.22), transparent 60%),
        radial-gradient(600px 400px at 20% 80%, rgba(0,200,255,.10), transparent 55%),
        var(--bg);
      color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;

      padding:12px;
      padding-top: max(12px, env(safe-area-inset-top));
      padding-bottom: max(12px, env(safe-area-inset-bottom));
      padding-left: max(12px, env(safe-area-inset-left));
      padding-right: max(12px, env(safe-area-inset-right));
    }

    .wrap{
      width:100%;
      max-width:420px;
      max-height: 100svh;
      display:flex;
      align-items:stretch;
      justify-content:center;
    }

    .card{
      width:100%;
      max-height: calc(100svh - 24px);
      overflow:auto;
      -webkit-overflow-scrolling: touch;

      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:12px 10px 10px;
    }

    .brand{
      width:100%;
      display:flex;
      justify-content:center;
      align-items:center;
      margin-bottom:6px;
      padding:6px 6px 0;
      text-align:center;
    }
    .brand img{
      width:100%;
      max-width:380px;
      height:60px;
      object-fit:contain;
      display:block;
    }

    .caption{
      text-align:center;
      font-weight:700;
      font-size:18px;
      letter-spacing:.2px;
      margin:4px 0 8px;
    }
    .divider{
      height:1px;
      background: var(--line);
      margin: 10px 0 14px;
    }
    .row{
      display:flex;
      align-items:center;
      justify-content:center;
      margin-top:6px;
      text-align:center;
    }
    .check{
      width:62px;
      height:62px;
      border-radius:999px;
      display:flex;
      align-items:center;
      justify-content:center;
      background: rgba(34,197,94,.12);
      border:1px solid rgba(34,197,94,.28);
    }
    .check svg{width:34px;height:34px; fill: var(--ok);}

    .title{
      font-size:26px;
      font-weight:900;
      margin:10px 0 0;
      line-height:1.1;
      text-align:center;
    }
    .sub{
      text-align:center;
      margin:10px 0 0;
      color: var(--muted);
      font-size:14px;
    }
    .sub strong{color: #bcd2ff; font-weight:900;}

    .pill-wrap{
      width:100%;
      display:flex;
      justify-content:center;
      align-items:center;
      margin-top:12px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      padding:10px 14px;
      border-radius:999px;
      background: rgba(255,255,255,.04);
      border:1px solid var(--line);
      color: var(--text);
      font-weight:800;
      max-width:100%;
      text-align:center;
    }
    .pill span{
      color: var(--muted);
      font-weight:700;
    }
    .pill b{
      font-weight:900;
      letter-spacing:.2px;
      word-break: break-all;
    }

    .info{
      margin:14px 0 0;
      text-align:center;
      color: var(--muted);
      font-size:12px;
    }

    .note{
      margin-top:14px;
      background: rgba(255,255,255,.04);
      border:1px solid var(--line);
      border-radius:18px;
      padding:14px;
      color: var(--muted);
      font-size:13px;
      line-height:1.45;
    }
    .note b{color: var(--text)}
    .wa{
      margin-top:12px;
      text-align:center;
      color: var(--text);
      font-weight:900;
      font-size:16px;
    }
    .wa2{
      margin-top:8px;
      display:flex;
      justify-content:center;
      align-items:center;
      gap:10px;
      font-size:20px;
      font-weight:900;
    }
    .wa2 svg{width:22px;height:22px; fill:#22c55e;}

    .wa-link{
      color: var(--text);
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:10px;
    }
    .wa-link:active{transform: translateY(1px);}
    .wa-link:hover{opacity:.92;}

    .btn{
      margin-top:14px;
      width:100%;
      display:block;
      text-align:center;
      padding:16px 16px;
      border-radius:18px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.05);
      color: var(--text);
      font-size:16px;
      font-weight:800;
      text-decoration:none;
      letter-spacing:.2px;
    }
    .btn:active{transform: translateY(1px);}

    .footer{
      margin-top:10px;
      text-align:center;
      color: rgba(233,238,247,.55);
      font-weight:600;
      letter-spacing:.2px;
      font-size:12px;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">

      <div class="brand">
        <img src="brand_header123.png" alt="PROHELMET" />
      </div>

      <div class="caption">Stay Safe. Stay Fresh.</div>
      <div class="divider"></div>

      <div class="row">
        <div class="check" aria-hidden="true">
          <svg viewBox="0 0 24 24"><path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"/></svg>
        </div>
      </div>

      <h1 class="title">Payment Successful</h1>
      <p class="sub"><strong id="amtText">₹—</strong> received securely.</p>

      <div class="pill-wrap">
        <div class="pill" id="txnPill">
          <span>Txn ID:</span> <b id="txnText">—</b>
        </div>
      </div>

      <div class="info">Your helmet is now in the sanitization cycle.</div>

      <div class="note">
        If you encounter any issues with <b>payment</b> or the <b>cleaning cycle</b>, don’t worry —
        please <b>reachout</b> to us with your payment screenshot and we will assist you on priority.

        <div class="wa">Message us at WhatsApp:</div>

        <div class="wa2">
          <a class="wa-link" id="waLink" href="https://wa.me/917207400693" target="_blank" rel="noopener">
            <svg viewBox="0 0 32 32" aria-hidden="true"><path d="M19.11 17.74c-.27-.14-1.6-.79-1.85-.88-.25-.09-.43-.14-.61.14-.18.27-.7.88-.86 1.06-.16.18-.32.2-.59.07-.27-.14-1.15-.42-2.19-1.33-.81-.72-1.36-1.6-1.52-1.87-.16-.27-.02-.42.12-.56.12-.12.27-.32.41-.48.14-.16.18-.27.27-.45.09-.18.05-.34-.02-.48-.07-.14-.61-1.47-.84-2.01-.22-.53-.44-.46-.61-.47h-.52c-.18 0-.48.07-.73.34-.25.27-.95.93-.95 2.27 0 1.34.97 2.64 1.11 2.82.14.18 1.91 2.92 4.62 4.1.64.28 1.14.45 1.53.58.64.2 1.23.17 1.69.1.52-.08 1.6-.65 1.83-1.28.23-.63.23-1.16.16-1.28-.07-.11-.25-.18-.52-.32zM16.02 26.67h-.01c-1.78 0-3.52-.48-5.03-1.39l-.36-.21-3.74.98 1-3.65-.23-.38a10.6 10.6 0 0 1-1.62-5.62c0-5.87 4.78-10.64 10.67-10.64 2.85 0 5.53 1.11 7.54 3.12a10.56 10.56 0 0 1 3.13 7.52c0 5.87-4.79 10.65-10.65 10.65zm9.05-19.7A12.71 12.71 0 0 0 16 3.33C9 3.33 3.33 8.98 3.33 15.96c0 2.3.62 4.55 1.8 6.52L3 30l7.7-2.02a12.6 12.6 0 0 0 5.3 1.18h.01c6.98 0 12.65-5.67 12.65-12.65 0-3.38-1.32-6.55-3.59-8.84z"/></svg>
            <span>7207400693</span>
          </a>
        </div>
      </div>

      <a class="btn" href="https://prohelmet0210.github.io/prohelmet/" target="_blank" rel="noopener">
        Visit Official Website
      </a>

      <div class="footer">©PROHELMET</div>

    </div>
  </div>

  <script>
  (function () {

    const params = new URLSearchParams(window.location.search);

    function getParam(keys) {
      for (const key of keys) {
        const value = (params.get(key) || "").trim();
        if (value) return value;
      }
      return "";
    }

    function formatAmount(v) {
      if (!v) return "";
      // If purely digits, treat as paise if >= 100
      if (/^[0-9]+$/.test(v)) {
        const n = Number(v);
        if (Number.isFinite(n) && n >= 100) return (n / 100).toFixed(2); // paise -> rupees
        return String(n);
      }
      // Already formatted like "49" or "49.00"
      return v;
    }

    /* ----------------------------
       TXN ID
       ---------------------------- */
    const txnId = getParam([
      "razorpay_payment_link_id",   // plink_...
      "plink",
      "razorpay_payment_id"         // fallback
    ]) || "—";

    /* ----------------------------
       AMOUNT
       Priority:
       1) explicit amt/amount/price in URL
       2) Razorpay amount keys (if ever present)
       3) fallback: parse from reference_id ONLY if you embed amount like "prohelmet-49-<anything>"
          (This will NOT guess from your timestamp-style reference ids.)
       ---------------------------- */
    let amount = getParam([
      "amt", "amount", "price",
      "razorpay_payment_link_amount",
      "razorpay_payment_link_amount_paid",
      "razorpay_payment_link_amount_due"
    ]);

    // Fallback: parse amount from reference id only if pattern matches prohelmet-<amount>-...
    if (!amount) {
      const ref = getParam(["razorpay_payment_link_reference_id"]);
      // Accept: prohelmet-49-xxxx or prohelmet-49.00-xxxx or prohelmet-4900p-xxxx (you control this)
      const m = ref.match(/^prohelmet-([0-9]+(?:\.[0-9]{1,2})?)(?:-|$)/i);
      if (m && m[1]) amount = m[1];
    }

    amount = formatAmount(amount);
    if (!amount) amount = "—";

    /* ----------------------------
       UPDATE UI
       ---------------------------- */
    const amtEl = document.getElementById("amtText");
    const txnEl = document.getElementById("txnText");

    if (amtEl) amtEl.textContent = (amount === "—") ? "₹—" : `₹${amount}`;
    if (txnEl) txnEl.textContent = txnId;

    /* ----------------------------
       UPDATE WHATSAPP LINK
       ---------------------------- */
    const waLink = document.getElementById("waLink");
    if (waLink) {
      const base = "https://wa.me/917207400693?text=";
      const msg = txnId === "—"
        ? "Hi ProHelmet, I need help with my payment/cleaning cycle."
        : `Hi ProHelmet, I need help with my payment/cleaning cycle. Txn: ${txnId}`;
      waLink.href = base + encodeURIComponent(msg);
    }

  })();
  </script>
</body>
</html>
